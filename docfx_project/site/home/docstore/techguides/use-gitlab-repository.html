<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Use GitLab repository for MarketPlace Sandbox </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Use GitLab repository for MarketPlace Sandbox ">
    <meta name="generator" content="docfx 2.21.1.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="how-to-use-gitlab-repository-for-marketplace-sandbox">How to use GitLab Repository for MarketPlace Sandbox</h1>

<h2 id="quick-start-guide">Quick Start Guide</h2>
<h3 id="audience">Audience</h3>
<p>This document can be used by technical staff who need to use GitLab repository to update files on the Temenos Sandbox provisioned through MarketPlace. Each Sandbox created has an associated GitLab Repository for uploading files, plugins, add-ons to the cloud environment (called Sandbox). The platform will perform the scripts and steps needed for the files to be deployed successfully as background activities. Before proceeding you need to know the associated GitLab repository, and have users with ssh keys created in the portal. </p>
<h1 id="install-gitbash-cli-for-windows">Install GitBash CLI for Windows</h1>
<p>You can use any GitLab/GitHub client. </p>
<div class="NOTE"><h5>Note</h5><p>If you already have installed a Git client on your computer, you can skip this step.</p>
</div>
<p>•   Download the installer from <a href="https://git-scm.com/download/win" title="https://git-scm.com/download/win">https://git-scm.com/download/win</a></p>
<p><img src="images/git-download.png" alt="git download"></p>
<p>•   Run the installer and click <strong>Next</strong> on each screen, without changing anything in configurations. Click <strong>Finish</strong> once completed.</p>
<h1 id="create-ssh-keys-pair-public-and-private-keys">Create SSH keys (pair public and private keys)</h1>
<p>•   Open Git Bash and run:</p>
<p><img src="images/ssh-keygen.png" alt="ssh keygen"></p>
<p>•   This creates a new ssh key, using the provided email as a label.</p>
<p><img src="images/generate-ssh-key.png" alt="generate ssh key"></p>
<p>•   When you&#39;re prompted to &quot;Enter a file in which to save the key,&quot; press Enter. This accepts the default file location.</p>
<p><img src="images/file-location.png" alt="file location"></p>
<p>•   At the prompt, press enter twice to create SSH keys without a passphrase:</p>
<p><img src="images/enter-passphrase.png" alt="enter passphrase"></p>
<p><img src="images/enter-passphrase-again.png" alt="enter passphrase again"></p>
<p>•   The screen should look like this:</p>
<p><img src="images/screen-key-generated.png" alt="screen key generated"></p>
<p>•   SSH keys are created and need to be added to ssh-agent. Ensure that ssh-agent is running. Run the command below:</p>
<p><img src="images/ssh-agent.png" alt="ssh agent"></p>
<p>•   Add your SSH private key to the ssh-agent. If you created your key with a different name, or if you are adding an existing key that has a different name, replace id_rsa in the command with the name of your private key file. Run the command below:</p>
<p><img src="images/replace-id.png" alt="replace id"></p>
<p>•   Output should be:</p>
<p><img src="images/add-ssh-key.png" alt="add ssh key"></p>
<p>•   Leave this Git Bash window open. Move to the next chapter to add your public key to portal. You will return to this window to clone the repository.</p>
<h1 id="add-users-in-portal-with-ssh-key">Add users in portal with SSH key</h1>
<p>•   Login to your organisation portal using the link and the credentials provided.</p>
<p><img src="images/portal-login.png" alt="portal login"></p>
<p>•   Click User menu and then New user button, as below:</p>
<p><img src="images/new-user.png" alt="new user"></p>
<p>This will create a new user in your organisation. This new user will be automatically assigned to all GitLab Repositories from within all environments. If you have already a user created, you can click on the user and update the SSH key box with the one created above.</p>
<p><img src="images/new-user-created.png" alt="new user created"></p>
<p>•   Public SSH key needs to be pasted in SSH Key text box. Open Windows Explorer and locate the public key generated above. Navigate to c:\users&lt;yourusername&gt;.ssh and locate the .pub file (id_rsa.pub). </p>
<p><img src="images/paste-keytext.png" alt="paste key text"></p>
<p>• Right click and open it with notepad. Select all and copy to clipboard.</p>
<p><img src="images/copy-key.png" alt="copy key"></p>
<p>•   Paste the copied text into the SSH Key text box and click Create user button.</p>
<p><img src="images/ssh-text-box.png" alt="ssh text box"></p>
<ul>
<li><p>Your username will be created in Gitlab server and public SSH key provided will be added to your account being accessible from all the environments created in your organisation.</p>
</li>
<li><p>For further details or issues related to Gitlab SSH keys usage, or other operating systems (MAC, Linux), please consult this link:  <a href="https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/">https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/</a></p>
</li>
</ul>
<h1 id="clone-the-repository-to-your-local-computer">Clone the Repository to your local computer</h1>
<p>Before proceeding, please login to your organisation, find your environment then locate the <strong>Repository</strong> Application and Endpoint. Right click the endpoint and copy the link address or click the <strong>copy to clipboard icon</strong> from the right:</p>
<p><img src="images/repository.png" alt="repository"></p>
<p>•   Create a folder where do you want to store the repository files. Let’s call it “repo”.</p>
<p>•   Go to Git Bash window. Change directory to the new created folder (“repo”). Type “cd /c/repo”, as below:</p>
<p><img src="images/repo.png" alt="repo"></p>
<p>•   Clone the Sandbox repository using the “git clone <url>” command, where <url> is the link copied above:<p>
<p><img src="images/clone-repo.png" alt="clone repo"></p>
<ul>
<li>Content is downloaded from the GitLab Repository to your computer:</li>
</ul>
<p><img src="images/download-content.png" alt="download content"></p>
<h1 id="push-files-to-sandbox">Push files to Sandbox</h1>
<p>The steps below will describe the way we can use the Git client to push files to the repository. This will be done using an example, but the same process can be applied to any file what we want to push in any folder from the Repository.</p>
<p>This example will show how to import a local database file to the Sandbox (Cloud Environment). For the H2 database to be imported correctly in the Cloud Environment, there are some conventions that need to be applied:</p>
<ul>
<li>User is t24 and password is t24 for the h2 database</li>
<li>Database file name needs to be “TAFJDB.h2.db” – case sensitive.</li>
<li>File needs to be uploaded as a ZIP file, with the name “TAFJDB.ZIP” (case sensitive).</li>
<li>If all the above conditions are satisfied, we just copy the TAFJDB.ZIP file to the database import location: “\corebanking\client_files\h2db”. Copy the file using explorer into this location. In this example is “C:\Repo\corebanking\client_files\h2db”:</li>
</ul>
<p><img src="images/db.png" alt="database"></p>
<ul>
<li>Open the Git Bash window. Change directory to the cloned Repo folder (/c/Repo/Corebanking). Type command “git status”. One file added or modified will be displayed:</li>
</ul>
<p><img src="images/git-status.png" alt="git status"></p>
<ul>
<li>We need to add the file to the commit list. This is done using the command “git add <files>”. Type “git add  client_files/h2db/TAFJDB.zip”:</files></li>
</ul>
<p><img src="images/git-add.png" alt="git add"></p>
<p><img src="images/git-confirm.png" alt="git confirm"></p>
<ul>
<li>We need to commit the changes and push to Repository. The command is “git commit -m <message text="">”:</message></li>
</ul>
<p><img src="images/git-commit.png" alt="git commit"></p>
<ul>
<li>Push the changes and type “git push”:</li>
</ul>
<p><img src="images/git-push.png" alt="git push"></p>
<ul>
<li>Changes were uploaded to the Repository. An automatic script is starting in background to update the Sandbox.</li>
</ul>
<h1 id="repository-folder-structure-and-description">Repository folder structure and description</h1>
<table>
<thead>
<tr>
<th><strong>Folder Name</strong></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>addons</td>
<td>This folder is designated for AppDynamics. Upload files as ZIP.</td>
</tr>
<tr>
<td>client_files\h2db</td>
<td>Local H2 database that will be uploaded to the cloud Sandbox. Database username must be t24 and password t24 (case sensitive). Database name is mandatory to be “TAFJDB.h2.db” (case sensitive) and must be archived as a ZIP with name TAFJDB.zip (case sensitive). If the above conditions are not satisfied, the database will not be uploaded to the cloud Sandbox. This procedure will <strong>replace</strong> the existing database in the cloud with this one. The <strong>old database</strong> will be <strong>lost</strong>, including any records loaded manually.</td>
</tr>
<tr>
<td>client_files\localjars</td>
<td>Upload here any local jars (not released by T24 Core). There can be any simple Jars used by T24 or other parties. All files will be copied to the module folder inside Jboss and the module.xml file will be updated automatically every time a new commit is triggered in this folder. If a Jar file is corrupted or there are missing dependencies, Jboss will fail to start and the Sandbox can’t be used. Fixing the issue, will trigger a new rebuild and Jboss restart.</td>
</tr>
<tr>
<td>packages</td>
<td>One or more T24 DS (Design Studio) packages can be uploaded into this folder. All packages will be deployed automatically inside T24.</td>
</tr>
<tr>
<td>plugins</td>
<td>WAR files can be uploaded in this folder. The files will be deployed inside Jboss EAP.</td>
</tr>
<tr>
<td>updates</td>
<td>The updates files downloaded from the portal in zip format. The files will be copied to the update folder and the T24 Update procedure is triggered.</td>
</tr>
<tr>
<td>wsdl</td>
<td>WSDL files and folders that are required by plug-ins (war file) need to be uploaded here.</td>
</tr>
</tbody>
</table>
</url></url></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
